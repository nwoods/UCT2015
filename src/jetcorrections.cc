#include "L1Trigger/UCT2015/interface/jetcorrections.h"


double jetcorrTAvg(double ptraw, double puLevel, int ieta) {

  double alpha[]={ // no cuts at all
    0.867711, 
    1.02641,  
    1.30385,  
    1.52004,  
    1.20444,  
    0.980615, 
    0.98932,  
    1.05603,  
    1.07091,  
    1.06304,  
    1.06518,  
    1.06375,  
    1.07798,  
    1.08122,  
    1.06115,  
    1.00966,  
    1.02007,  
    1.2168,   
    1.50508,  
    1.30008,  
    0.999099, 
    0.864286};



    // redo with PU
//     0.895797,
//     1.08165, 
//     1.33042, 
//     1.53114, 
//     1.20438, 
//     0.98106, 
//     0.989534,
//     1.05707, 
//     1.07174, 
//     1.06398, 
//     1.06596, 
//     1.06432, 
//     1.07826, 
//     1.08201, 
//     1.06214, 
//     1.00979, 
//     1.02056, 
//     1.21793, 
//     1.51227, 
//     1.3214,  
//     1.05075, 
//     0.907389};


//     0.867711, 
//     1.02641,  
//     1.30385,  
//     1.52004,  
//     1.20444,  
//     0.980615, 
//     0.98932,  
//     1.05603,  
//     1.07091,  
//     1.06304,  
//     1.06518,  
//     1.06375,  
//     1.07798,  
//     1.08122,  
//     1.06115,  
//     1.00966,  
//     1.02007,  
//     1.2168 ,  
//     1.50508,  
//     1.30008,  
//     0.999099, 
//     0.864286};

//     0.917342, 1.08373, 1.33885, 1.53641, 
//     1.20536, 0.980639, 0.98932, 1.05603,
//     1.07091, 1.06307, 1.06522, 1.06377,
//     1.07799, 1.08121, 1.06115, 1.00966,
//     1.02009, 1.21765, 1.52313, 1.33939,
//     1.06182, 0.911627};

//   double beta[] = {
//     -0.289618, 
//     -0.797965, 
//     -0.807688, 
//     -0.915057, 
//     -1.50565,  
//     -1.94768,  
//     -1.89901,  
//     -2.10863,  
//     -2.08356,  
//     -1.83178,  
//     -1.7867,   
//     -1.87016,  
//     -1.82494,  
//     -1.88024,  
//     -1.9623,   
//     -1.7112,   
//     -1.83263,  
//     -1.63291,  
//     -0.888606, 
//     -0.878233, 
//     -0.760846, 
//     -0.89335};

  // 20 GeV cut
//     -0.678366,
//     -0.770852,
//     -0.873943,
//     -1.04581, 
//     -1.8838,  
//     -2.31705, 
//     -2.3501,  
//     -2.52118, 
//     -2.47518, 
//     -2.1402,  
//     -2.07349, 
//     -2.12401, 
//     -2.11872, 
//     -2.28946, 
//     -2.34456, 
//     -2.16784, 
//     -2.20118, 
//     -1.9539,  
//     -0.96018, 
//     -0.899818,
//     -0.745419,
//     -0.689394};

  double gamma[] = {
    11.2146,
    5.67163,
    1.89038,
    4.07677,
    16.8013,
    18.2999,
    20.56,	 
    19.362, 
    17.3111,
    16.1556,
    14.7054,
    15.063, 
    16.0927,
    17.3563,
    19.4758,
    20.1121,
    17.9698,
    16.8004,
    4.23236,
    1.72167,
    6.12111,
    11.1815};


  // 30 GeV cut
//     17.1074,
//     12.7079,
//     9.72478,
//     13.3661,
//     23.7897,
//     22.277,	
//     25.2262,
//     24.8477,
//     23.4421,
//     22.6543,
//     21.5988,
//     22.2668,
//     22.4577,
//     23.1484,
//     24.785,	
//     24.5578,
//     21.6208,
//     23.797,	
//     13.6186,
//     9.63565,
//     13.1498,
//     19.186};


  // 20 GeV cut
//     13.5094,
//     9.88804,
//     7.36729,
//     9.08225,
//     21.0233,
//     21.0789,
//     23.4619,
//     23.0103,
//     21.4364,
//     20.431, 
//     19.3789,
//     19.8612,
//     20.2114,
//     21.1979,
//     22.8835,
//     22.7818,
//     20.5152,
//     20.9407,
//     8.8169, 
//     7.52497,
//     10.272, 
//     13.3236};

//     11.2146,
//     5.67163,
//     1.89038,
//     4.07677,
//     16.8013,
//     18.2999,
//     20.56,  
//     19.362, 
//     17.3111,
//     16.1556,
//     14.7054,
//     15.063, 
//     16.0927,
//     17.3563,
//     19.4758,
//     20.1121,
//     17.9698,
//     16.8004,
//     4.23236,
//     1.72167,
//     6.12111,
//     11.1815};
  

//     10.0278, 3.46754, 0.172832, 3.23472, 
//     16.7919, 18.3008, 20.56, 19.362, 17.3111,
//     16.1558, 14.7058, 15.0636, 16.0928, 
//     17.3564, 19.4758, 20.1121, 17.9707, 
//     16.6958, 3.22106, -0.210373, 3.78894, 
//     9.88917};

  double pt =  alpha[ieta] * ptraw /*+ beta[ieta] * puLevel*/ 
    + gamma[ieta];

  return pt;
}

double jetcorr(double ptraw, int ieta, unsigned int pu) {

  double calib[]={ // no cuts at all
    0.892188, -0.651711, 10.2378, 4.58121,
    1.02586, -1.33642, 4.81479, 9.36397,
    1.27058, -1.50567, 2.07494, 10.4648,
    1.50522, -1.31665, 4.08716, 8.85142,
    1.26861, -0.835476, 16.0302,5.40097,
    1.21747, -0.390929, 21.335, 2.47538,
    1.24958, -0.222715, 21.7479,1.56268,
    1.23016, -0.280122, 22.383,1.79817,
    1.20706, -0.294144, 20.5458,1.92008,
    1.16759, -0.268146, 19.5496,1.74353,
    1.18027, -0.343445, 17.7221,2.23023,
    1.18262, -0.330986, 18.0593,2.13182,
    1.20777, -0.34207, 19.1141, 2.22131,
    1.23128, -0.327868, 20.1695,2.12529,
    1.26521, -0.301663, 21.5901,1.9261,
    1.22042, -0.297534, 22.2525,1.93023,
    1.21491, -0.296532, 22.0371,1.91047,
    1.28441, -0.810513, 15.964,5.24753,
    1.49075, -1.28715, 4.51183,8.75857,
    1.30826, -1.49382, 1.10413,10.3965,
    0.991312, -1.25799, 5.38376,8.87343,
    0.938214, -0.710223, 9.25766,5.20865,};

  double alpha = calib[3*ieta + 0];
  double beta  = calib[3*ieta + 1];
  double gamma = calib[3*ieta + 2];
  double delta = calib[4*ieta + 3];       

  double pt =  alpha * ptraw + beta * pu + gamma + delta;

  return pt;
}


double jetcorrUIC(double ptraw, int ieta, unsigned int pu) {


  double calib[]={ // no cuts at all
    0.892188, -0.651711, 10.2378, 4.58121,
    1.02586, -1.33642, 4.81479, 9.36397,
    1.27058, -1.50567, 2.07494, 10.4648,
    1.50522, -1.31665, 4.08716, 8.85142,
    1.26861, -0.835476, 16.0302,5.40097,
    1.21747, -0.390929, 21.335, 2.47538,
    1.24958, -0.222715, 21.7479,1.56268,
    1.23016, -0.280122, 22.383,1.79817,
    1.20706, -0.294144, 20.5458,1.92008,
    1.16759, -0.268146, 19.5496,1.74353,
    1.18027, -0.343445, 17.7221,2.23023,
    1.18262, -0.330986, 18.0593,2.13182,
    1.20777, -0.34207, 19.1141, 2.22131,
    1.23128, -0.327868, 20.1695,2.12529,
    1.26521, -0.301663, 21.5901,1.9261,
    1.22042, -0.297534, 22.2525,1.93023,
    1.21491, -0.296532, 22.0371,1.91047,
    1.28441, -0.810513, 15.964,5.24753,
    1.49075, -1.28715, 4.51183,8.75857,
    1.30826, -1.49382, 1.10413,10.3965,
    0.991312, -1.25799, 5.38376,8.87343,
    0.938214, -0.710223, 9.25766,5.20865,};

  double alpha = calib[4*ieta + 0];
  double beta  = calib[4*ieta + 1];
  double gamma = calib[4*ieta + 2];
  double delta = calib[4*ieta + 3];       

  double pt =  alpha * ptraw + beta * pu + gamma + delta;
  return pt;
}
